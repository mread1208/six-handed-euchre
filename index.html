<!DOCTYPE html>
<html>
    <head>
        <title>Socket.IO chat</title>
        <link href="static/style.css" type="text/css" rel="stylesheet" />
    </head>
    <body>
        <ul id="messages"></ul>
        <form id="nickname" action="/">
            <input id="name" type="text" required autocomplete="off" /><button>Join Room</button>
        </form>

        <script src="/socket.io/socket.io.js"></script>
        <script>
            (function() {
                const socket = io();
                const nicknameForm = document.querySelector("#nickname");
                const messagesList = document.querySelector("#messages");

                nicknameForm.addEventListener("submit", e => {
                    e.preventDefault();
                    socket.emit(`join_room`, e.target.name.value);
                    e.target.name.value = "";
                    return false;
                });

                socket.on(`chat_message`, msg => {
                    const listItem = document.createElement(`li`);
                    listItem.textContent = msg;
                    messagesList.appendChild(listItem);
                });
            })();
        </script>
    </body>
</html>
